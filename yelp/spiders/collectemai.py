# -*- coding: utf-8 -*-
import scrapy
import re


class CollectemailSpider(scrapy.Spider):
    name = 'collectemail'
    start_urls = ['http://eatoeb.com','http://rougecalgary.com','http://grumans.ca','http://briggskandb.com','http://damascuscalgary.com','http://inglewooddrivein.com','http://blowersgrafton.com','http://cardinale.ca','http://theguildrestaurant.com','http://stateandmain.ca','http://deagla.com','http://po-ke.ca','http://dirtbelly.com','http://mercatowest.com','http://spolumbos.com','http://teffngreens.ca','http://nawabrestaurant.ca','http://shawarmaknight.com','http://sharkclub.com','http://thaiexpress.ca','http://hanasushi.ca','http://demetrispizza.com','http://waterlookitchenandbar.com','http://naanstopgrill.ca','http://keithsdeli.com','http://sajbakerycalgary.com','http://redlobster.com','http://mukujapaneseramen.ca','http://bellaroma.ca','http://masacalgary.com','http://homeandawayyyc.com','http://pzaparlour.com','http://web.aw.ca','http://sushitoki.ca','http://greenchili.ca','http://rajdoot.ca','http://snowpalacecalgary.com','http://cloud9sheesha.com','http://chianticafe.ca','http://kabuku.ca','http://muchoburrito.com','http://deerfootinn.com','http://riverbendpekinghouse.com','http://fiveguys.com','http://kegsteakhouse.com','http://theturmeric.ca','http://fiddlerscourtyard.com','http://thai-nk.com','http://namvk.com','http://jerusalem-shawarma.ca','http://jimmysaanda.com','http://cherryinn.ca','http://indiquecalgary.com','http://spudmobeel.ca','http://thaiexpress.ca','http://scotianstyle.ca','http://chicagodeepdish.com','http://bowtiepizza.com','http://sonomaon9th.ca','http://tajmahal-calgary.com','http://tassebakery.com','http://trawlersseafood.com','http://bagolacsaigon.ca','http://phobinhminhcalgary.com','http://eatdrinkblock.com','http://silverinnrestaurant.com','http://redsdiner.com','http://ceilis.com','http://hungariandeli.ca','http://orientalphoenix.ca','http://toishanrestaurant.com','http://bunmee.net','http://kabuku.ca','http://royalindia-calgary.com','http://burgerinn.com','http://viacibo.com','http://humptys.com','http://pasu.com','http://chickenonthewaycalgary.ca','http://namisushi.ca','http://tuktukthai.com','http://originaljoes.ca','http://greenchili.ca','http://jackastors.com','http://themet.ca','http://bottlescrewbill.com','http://ourdailybrett.com','http://holygrill.ca','http://ladybugandcafe.com','http://burger320.com','http://chianticafe.ca','http://originaljoes.ca','http://mooscountryicecream.com','http://tonyromas.com','http://townshipbarandgrill.com','http://Chilliescalgary.com','http://ldvpizzabar.com','http://pulcinella.ca','http://myvillageyyc.com','http://zen8grill.ca','http://cracoviadeli.com','http://kegsteakhouse.com','http://southstburger.com','http://ntnl.ca','http://saigon-royal.com','http://mazajloungecalgary.com','http://biteyyc.com','http://ss106.ca','http://buffalowildwings.com','http://villagespizza.com','http://lougheedhouse.com','http://vanexpress.business.site','http://carlsjr.ca','http://fatburger.ca','http://wellingtonsofcalgary.com','http://ntnl.ca','http://skylarkrestaurant.ca','http://heritagebakeryanddeli.ca','http://marriott.com','http://euphoriacafe.ca','http://thaiboat.ca','http://japanese-village.ca','http://lolasfilipinokitchen.com','http://inspiredgo.ca','http://brownssocialhouse.com','http://falafelking.ca','http://spice-hut.com','http://glenmoreinn.com','http://levilla.ca','http://amandinebakery.net','http://goldencentralchinese.com','http://samosafactory.ca','http://goldeninn.ca','http://greyeagleresortandcasino.ca','http://chop.ca','http://thecanadianbrewhouse.com','http://joeyrestaurants.com','http://italianstore.ca','http://kanpaicalgary.com','http://phohuongviet.com','http://tuktukthai.com','http://originaljoes.ca','http://orientalhousecalgary.com','http://craftbeermarket.ca','http://parkkitchen.ca','http://vinroom.com','http://joeyrestaurants.com','http://sushipartyblog.wordpress.com','http://chilitos.ca','http://odysseyYYC.com','http://emeraldgardenrestaurant.ca','http://gyu-kaku.com','http://timhortons.ca','http://earthsoven.com','http://pitabasket.com','http://heartschoices.com','http://meshicalgary.com','http://phils.ca','http://chezcora.com','http://ambrosiaveggie.com','http://thechickpea.ca','http://cadencecoffee.com','http://winsport.ca','http://calgarymeats.com','http://marathonethiopian.ca','http://philson11th.ca','http://saffrontakeout.ca','http://phils.ca','http://restaurants.nordstrom.com','http://1600bierhaus.com','http://tintindimsum.com','http://shefsfierykitchen.com','http://binchoizakaya.business.site','http://seniorespizza.ca','http://mrschnappspubandgrill.com','http://forkandsalad.com','http://eattrattoria.ca','http://cibocalgary.com','http://houseofkabob.ca','http://sheratoncavaliercalgary.com','http://brownssocialhouse.com','http://www3.telus.net','http://rossocoffeeroasters.com','http://tuktukthai.com','http://onopokeco.com','http://shawarma-palace.com','http://fahadrestaurant.com','http://originaljoes.ca','http://la-viena-calgary.com','http://waalflower.ca','http://triocafe.ca','http://shawarma-palace.com','http://milanocoffee.ca','http://cactusclubcafe.com','http://theplacerestaurant.ca','http://ntnl.ca','http://doublezeropizza.ca','http://holysmokebbq.ca','http://pekingdragon.ca','http://tasteofcalgary.com','http://thehexcafe.com','http://spolumbos.com','http://fivespicekitchenyyc.com','http://tereskitchen.ca','http://punjabichulha.ca','http://smashburger.com','http://darumacalgary.com','http://damascafe.ca','http://blancocantina.ca','http://saigonthai.org','http://saltnpepper.ca','http://whitespot.ca','http://buchanans.ca','http://newfoodorder.com','http://tandooripalacecalgary.ca','http://powpizza.ca','http://rajasgrillcalgary.com','http://redlobster.com','http://dspotdessert.com','http://shawarmabarlow.com','http://goldenbell.ca','http://mrlu-restaurant.business.site','http://justbbq.ca','http://caribbeanchoicecalgary.ca','http://pocolocopizza.com','http://chronictacos.com','http://misterchensyyc.com','http://tandoorigrillcalgary.com','http://migarock.ca','http://spotoncalgary.com','http://rusticsourdoughbakery.com','http://kretasouvlaki.business.site','http://anejo.ca','http://bkkstreetfood.com','http://spirospizza.ca','http://frenchieyyc.com','http://cibocalgary.com','http://shawarmaave.ca','http://cliveburger.com','http://regrub.ca','http://regrub.ca','http://lilempireburger.com','http://escoba.ca','http://littlespice.ca','http://nikosbistro.ca','http://murrietas.ca','http://OliveGarden.com','http://trylajawab.com','http://barburrito.ca','http://healthfare.ca','http://quesada.ca','http://cinnamoncalgary.ca','http://jinya-ramenbar.com','http://villafirenze.ca','http://CalgaryPho.com','http://meatandbread.com','http://barleymillcalgary.com','http://goldenbell.ca','http://sauceitalianmarket.com','http://saigonrex.ca','http://michaelspizza.ca','http://rossocoffeeroasters.com','http://sukiyakihouse.com','http://metal-galaxy.com','http://oceanacalgary.com','http://velocafeyyc.com','http://nextdoorwinebar.ca','http://brokenplate.ca','http://sultanstent.ca','http://salsita.ca','http://samurairamen-sushi.com','http://koreanvillagecalgary.com','http://citypalate.ca','http://pizzeriagaga.ca','http://sky360.ca','http://austrianclub.ca','http://seoulbbqrestaurant.ca','http://sheratoncavaliercalgary.com','http://tasteofasiagroup.ca','http://marriott.com','http://streats.ca','http://commonbondyyc.com','http://nupo.ca','http://kegsteakhouse.com','http://eatcopperbranch.com','http://sucrecafe.com','http://noodlebox.ca','http://restaurantpuspa.com','http://minhasbrewery.com','http://saltlik.com','http://kecharcoalgrill.com','http://carminespizza.ca','http://rockymountainbbq.ca','http://biteyyc.com','http://singaporesams.com','http://barvonderfels.com','http://popeyeschicken.ca','http://millstreetbrewery.com','http://myhresdeli.com','http://cravingsmarketrestaurant.com','http://avenidamarket.ca','http://big-fish.ca','http://anatoliaturkishfood.ca','http://franksonmacleod.com','http://motimahal.ca','http://nickssteakandpizza.com','http://calcuttacricketclub.com','http://shawarma-palace.com','http://vicshongkong.com','http://sabores.ca','http://cafewisk.ca','http://mazajloungecalgary.com','http://vintagechophouse.com','http://dirtbelly.com','http://thebluescan.com','http://goldencactus.ca','http://perogyboyz.com','http://francas.ca','http://velvetcafecalgary.ca','http://stromboliinn.com','http://finedinerbistro.ca','http://tasteofasiagroup.ca','http://pegasuscalgary.com','http://fatimakarahicorner.com','http://bolsarestaurant.com','http://veginyyc.com','http://reasitaliancucina.com','http://goodearthcoffeehouse.com','http://veganstreeteats.ca','http://dethaicuisine.com','http://lalunarossa.ca','http://bonterra.ca','http://heavengf.com','http://purekitchenbar.com','http://eatatwill.ca','http://chop.ca','http://thai-sa-on.com','http://bigcatchcalgary.ca','http://thecassisbistro.ca','http://unapizzeria.com','http://calypsostaverna.com','http://PhuongViNoodleHouse.ca','http://moxies.ca','http://begim.ca','http://silverdragoncalgary.com','http://ruthschris.net','http://aladdinscasbah.ca','http://wiseandwright.com','http://jerusalemshawarma.ca','http://eatcarino.com','http://deanehouse.com','http://thestreeteatery.com','http://sidewalkcitizenbakery.com','http://westincalgary.com','http://milestonesrestaurants.com','http://pampasteakhouse.com','http://shokuninyyc.ca','http://eatcopperbranch.com','http://momsplace.ca','http://kamhan.ca','http://noodlebox.ca','http://nandos.ca','http://thaibistro.ca','http://scarpettaeatery.com','http://justaroundthebend.ca','http://namvk.com','http://garosukorean.com','http://open-range.ca','http://ishtarrestaurant.ca','http://borobudursf.com','http://kalinka.ca','http://santorinirestaurant.com','http://donnamacyyc.ca','http://beirutstreetfood.ca','http://po-ke.ca','http://phohuongviet-calgary.com','http://thedandelionyyc.ca','http://vendomecafe.com','http://nandos.ca','http://freehouseyyc.com','http://minassteakhouse.com','http://calgaryteppanyaki.com','http://tutierra.ca','http://pekinghouse98.ca','http://wednesdayroom.com','http://nikospizza.ca','http://posto.ca','http://konapoke.com','http://verobistro.ca','http://olivechicken10ave.ca','http://thecoup.ca','http://oldspaghettifactory.ca','http://daguricenoodle.ca','http://thespicyamigos.com','http://thejamaicanjerk.ca','http://modernsteak.ca','http://littlelebanonpita.com','http://tekkotsucalgary.weebly.com','http://fionnmaccools.com','http://blackfootdiner.ca','http://beefunhotpot.com','http://allorarestaurant.com','http://labrezza.ca','http://janebondgrill.com','http://hotmessyyc.com','http://breadandcircusyyc.com','http://teatro.ca','http://deltahotels.com','http://Trolley5.com','http://cluckncleaver.com','http://purlieucalgary.ca','http://sandongbanjeom.com','http://ogamchicken.com','http://thepalomino.ca','http://royaleyyc.ca','http://linasmarket.com','http://aidasbistro.ca','http://padthaicalgary.com','http://freshsifoods.com','http://redheadscafe.com','http://bigtsbbq.com','http://redsdiner.com','http://jackiesthai.ca','http://rodneysoysterhouse.com','http://qhautecuisine.com','http://alumnisandwiches.com','http://dutchpancakes.ca','http://gardenofitaly.com','http://koicalgary.com','http://thegooseyyc.ca','http://edelweissimports.com','http://chiliclub.ca','http://flowerandwolfcalgary.com','http://stagewestcalgary.com','http://greattastecalgary.com','http://simplyirie.ca','http://6a-snack-bar.business.site','http://barcelonatavern.com','http://bubblewafflecafe.ca','http://tazzafresh.com','http://savegcafe.ca','http://ajito.ca','http://lacasalatina.net','http://charbar.ca','http://jureesthaiplace.com','http://termehcalgary.ca','http://ricardoshideaway.ca','http://brasseriekensington.com','http://madisons1212.com','http://kleinharris.com','http://kensingtonriversideinn.com','http://fleurdeselbrasserie.com','http://blinkcalgary.com','http://ikemenramenbar.business.site','http://safarigrillcalgary.com','http://joeyrestaurants.com','http://alloydining.com','http://bookersbbq.com','http://jollibeecanada.com','http://cleavercalgary.com','http://thecaptainsboil.com','http://holygrill.ca','http://abyssiniarestaurant.ca','http://paddysbrewbecue.com','http://modernocean.ca','http://mercatogourmet.com','http://kingeddy.ca','http://tasteofkorea.ca','http://smugglers.ca','http://pioperu.com','http://milktigerlounge.ca','http://4thspot.com','http://cattlebaroncalgary.com','http://one18empire.com','http://thebeltliner.com','http://river-cafe.com','http://brokinyolk.ca','http://cottoyyc.com','http://seednsalt.com','http://flamemountainbbq.com','http://shikimenya.ca','http://warehousegroup.ca','http://haydenblockyyc.com','http://drinkbambu.com','http://darktable.ca','http://thecollectiveraw.com','http://chixeggshop.com','http://eatcucina.com','http://lakehousecalgary.com','http://localon8thave.com','http://alforno.ca','http://pbandjyyc.ca','http://tacosmexicoyyc.com','http://empanadaqueen.ca','http://kims-katsu.business.site','http://lastbestbrewing.com','http://belmontdiner.com','http://stonebowlkorean.com','http://kingsrestaurant.net','http://namonaturals.com','http://schnitzel.ca','http://cactusclubcafe.com','http://bigrockgrill.com','http://anatoliaturkishfood.ca','http://sait.ca','http://pubblicoitaliankitchen.com','http://edenbistro.ca','http://katsuten.ca','http://thenashyyc.com','http://ktownfriedchicken.com','http://marketcalgary.ca','http://thedapperdoughnut.com','http://tavernettayyc.ca','http://monkibistro.ca','http://theallium.ca','http://pigeonholeyyc.ca','http://wakadoramen.com','http://petersdrivein.com','http://empireprovisions.com','http://foofood.ca','http://masalabhavan.com','http://cactusclubcafe.com','http://teahouseyyc.com','http://saigon-highlands.business.site','http://eggsmart.ca','http://thederrickyyc.com','http://cafealchemist.com','http://lifestylesbistro.ca','http://therecroom.com','http://flavourcuisineandcatering.com','http://rtbsimmons.ca','http://hyatt.com','http://pregocalgary.com','http://kingfisherseafood.net','http://kingsrestaurant.net','http://raubistro.com','http://pelicanpier.ca','http://brazilianbbq.ca','http://bolerocalgary.com','http://sobyseatery.com','http://butcherbakeryyc.com','http://sobankoreanbbq.com','http://goroandgun.ca','http://monkibistro.ca','http://savoyscalgary.com','http://selkirkgrille.ca','http://moxies.ca','http://dennys.com','http://rawbaryyc.ca','http://zipang.ca','http://twopenny.ca','http://azzurripizzeria.ca','http://centini.com','http://socialbeerhaus.com','http://shijosushi.ca','http://foreignconcept.ca','http://livingroomrestaurant.ca','http://latelycalgary.ca','http://peppinogourmet.com','http://sidestreetpubandgrill.com','http://therockfort.ca','http://shawarmabarlow.com','http://lemongarden.canadachinese.ca','http://jeannespizzapantry.com','http://luxorcafe.ca','http://dinerdeluxe.com','http://yellowdoorbistro.ca','http://nativetongues.ca','http://dairylanecafe.ca','http://comeryblock.com','http://calanbeefnoodle.ca','http://zcrewcafe.com','http://n9na.ca','http://bennysbreakfastbar.ca','http://nightsandweekends.ca','http://ibaoza.com','http://holygrill.ca','http://khaosanthaikitchen.ca','http://shoeandcanoe.ca','http://notabletherestaurant.ca','http://modelmilk.ca','http://tokyostreetmarket.com','http://bridgettebar.com','http://brekkie.ca','http://himalayancuisine.ca','http://workshopcalgary.com','http://bluestardiner.ca','http://eatoeb.com','http://tenfoothenry.com']

    # start_urls = [
    #     'https://www.purlieucalgary.ca/',
    #     'https://vendomecafe.com/',
    #     'https://www.nandos.ca/',
    #     'http://littlelebanonpita.com',
    #     'https://www.sait.ca/',
    #     'https://chicagodeepdish.com/',
    #     'https://www.sonomaon9th.ca/',
    #     'http://bottlescrewbill.com',
    #     'https://rossocoffeeroasters.com/',
    #     'https://chop.ca/contact-us',
    #     'https://spice-hut.com/',
    #     'http://deerfootinn.com'
    # ]

    def parse(self, response):
        Url = response.request.url
        try:
            emails = re.findall("[A-Za-z0-9._-]+@[a-z0-9_-]+[.]+[a-z]+", str(response.body))
            if emails != []:
                uniquemail = set(emails)
                mail = set()
                for i in uniquemail:
                    if i.endswith('png') or i.endswith('jpg') or i.endswith('gif') or i.endswith('press') or i.endswith('food') or i.endswith('time') or i.endswith('test.com') or i.endswith('mail.com') or i.endswith('example.com') or i.endswith('press.io'):
                        continue
                    else:
                        mail.add(i)
                emailid = " | ".join(mail)
            else:
                contact = response.xpath('//a[contains(@href,"contact")]/@href').get()
                contactlink = response.urljoin(contact)
                yield scrapy.Request(contactlink, callback=self.parse)
                # emailid = 'N/A'
        except:
            pass
        if emailid != '':
            yield {'Email':emailid, "Url":Url}

